<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Solar Monitor Pro - Pleiku Operation Center</title>
    
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    
    <!-- Chart.js -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <!-- Chart.js Data Labels Plugin -->
    <script src="https://cdn.jsdelivr.net/npm/chartjs-plugin-datalabels@2.0.0"></script>
    
    <!-- Lucide Icons -->
    <script src="https://unpkg.com/lucide@latest"></script>

    <style>
        /* Custom Palette configuration */
        :root {
            --color-primary: #009BB3;   /* Teal/Blue */
            --color-secondary: #CBDAA4; /* Sage Green */
            --color-accent1: #DFE583;   /* Lime */
            --color-accent2: #F36859;   /* Coral Red */
            --color-neutral: #CCCCCC;
            --color-text: #374151;
        }
        .bg-primary { background-color: var(--color-primary); }
        .text-primary { color: var(--color-primary); }
        .text-accent2 { color: var(--color-accent2); }
        
        /* Custom Scrollbar */
        ::-webkit-scrollbar { width: 8px; height: 8px; }
        ::-webkit-scrollbar-track { background: #f1f1f1; }
        ::-webkit-scrollbar-thumb { background: #c1c1c1; border-radius: 4px; }
        ::-webkit-scrollbar-thumb:hover { background: #a8a8a8; }
        
        .hidden-tab { display: none; }
        .active-tab-btn { background-color: white; color: var(--color-primary); box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1); }
        .inactive-tab-btn { color: #E0F2FE; }
        .inactive-tab-btn:hover { background-color: rgba(255, 255, 255, 0.1); }
        
        @keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }
        .animate-fade-in { animation: fadeIn 0.5s ease-out forwards; }
    </style>
</head>
<body class="bg-slate-50 font-sans text-gray-900 min-h-screen pb-12">

    <!-- Header -->
    <header class="text-white shadow-xl sticky top-0 z-50" style="background: linear-gradient(to right, #1e293b, var(--color-primary));">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 h-16 flex items-center justify-between">
            <div class="flex items-center gap-3">
                <div class="bg-yellow-400 p-1 rounded-full"><i data-lucide="sun" class="w-6 h-6 text-indigo-900"></i></div>
                <div>
                    <h1 class="text-xl font-bold">Solar Monitor Pro</h1>
                    <p class="text-[10px] opacity-80 uppercase">Pleiku Operation Center</p>
                </div>
            </div>
            <nav class="flex space-x-1 bg-white/10 p-1 rounded-xl">
                <button onclick="switchTab('dashboard')" id="btn-dashboard" class="px-4 py-2 rounded-lg text-sm font-medium transition-all active-tab-btn">T·ªïng quan</button>
                <button onclick="switchTab('analysis')" id="btn-analysis" class="px-4 py-2 rounded-lg text-sm font-medium transition-all inactive-tab-btn">Ph√¢n t√≠ch & B√°o c√°o</button>
                <button onclick="switchTab('strategy')" id="btn-strategy" class="px-4 py-2 rounded-lg text-sm font-medium transition-all inactive-tab-btn">Chi·∫øn l∆∞·ª£c</button>
            </nav>
        </div>
    </header>

    <main class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8">
        
        <!-- ALERT: DATA UPDATE -->
        <div class="bg-green-50 border-l-4 border-green-400 p-4 mb-6 rounded-r shadow-sm">
            <div class="flex items-center">
                <div class="flex-shrink-0">
                    <i data-lucide="database" class="h-5 w-5 text-green-600"></i>
                </div>
                <div class="ml-3">
                    <p class="text-sm text-green-800">
                        <span class="font-bold">D·ªØ li·ªáu ƒë·ªìng b·ªô:</span> H·ªá th·ªëng ƒë√£ c·∫≠p nh·∫≠t to√†n b·ªô s·ªë li·ªáu chi ti·∫øt t·ª´ng th√°ng cho 3 nh√† m√°y (√Ånh Quang, Duy Ti√™n, Khoa Vi·ªát) theo b√°o c√°o quy·∫øt to√°n m·ªõi nh·∫•t.
                    </p>
                </div>
            </div>
        </div>

        <!-- DASHBOARD TAB -->
        <div id="tab-dashboard" class="space-y-8 animate-fade-in">
            <!-- 1. KPI Cards -->
            <div class="grid grid-cols-1 md:grid-cols-4 gap-4">
                <div class="bg-white p-4 rounded-xl shadow-sm border border-gray-200">
                    <p class="text-xs font-bold text-gray-400 uppercase">T·ªïng Doanh Thu (2022-2025)</p>
                    <h3 class="text-2xl font-bold text-gray-800 mt-1" id="kpi-total-revenue">...</h3>
                    <div class="mt-2 text-xs text-green-600 flex items-center gap-1"><i data-lucide="trending-up" class="w-3 h-3"></i> S·ªë li·ªáu th·ª±c t·∫ø</div>
                </div>
                <div class="bg-white p-4 rounded-xl shadow-sm border border-gray-200">
                    <p class="text-xs font-bold text-gray-400 uppercase">Doanh thu TB/NƒÉm</p>
                    <h3 class="text-2xl font-bold text-gray-800 mt-1">~8.5 T·ª∑</h3>
                    <div class="mt-2 text-xs text-blue-600">ƒê·∫°t 98% k·∫ø ho·∫°ch</div>
                </div>
                <div class="bg-white p-4 rounded-xl shadow-sm border border-gray-200">
                    <p class="text-xs font-bold text-gray-400 uppercase">D√≤ng ti·ªÅn T√≠ch l≈©y</p>
                    <h3 class="text-2xl font-bold text-emerald-600 mt-1">D∆∞∆°ng (+)</h3>
                    <div class="mt-2 text-xs text-gray-500">ƒê√£ qua ƒëi·ªÉm h√≤a v·ªën</div>
                </div>
                <div class="bg-white p-4 rounded-xl shadow-sm border border-gray-200">
                    <p class="text-xs font-bold text-gray-400 uppercase">Tr·∫°ng th√°i Thi·∫øt b·ªã</p>
                    <h3 class="text-2xl font-bold text-gray-800 mt-1">·ªîn ƒë·ªãnh</h3>
                    <div class="mt-2 text-xs text-orange-500 flex items-center gap-1"><i data-lucide="alert-triangle" class="w-3 h-3"></i> L∆∞u √Ω m√πa m∆∞a T7-T8</div>
                </div>
            </div>

            <!-- 2. SECTION: DOANH THU & PH√ÇN T√çCH (UPDATED LAYOUT) -->
            <!-- Revenue Chart + Analysis Panel -->
            <div class="grid grid-cols-1 lg:grid-cols-3 gap-6">
                <div class="lg:col-span-2 bg-white p-6 rounded-xl shadow-sm border border-gray-200">
                    <h2 class="text-lg font-bold mb-4 flex items-center gap-2 text-gray-800">
                        <i data-lucide="activity" class="w-5 h-5 text-primary"></i> 
                        Bi·ªÉu ƒë·ªì Bi·∫øn ƒë·ªông Doanh thu (M·ªÅm m·∫°i & D·ªÖ theo d√µi)
                    </h2>
                    <div class="h-80"><canvas id="chart-total-revenue-line"></canvas></div>
                </div>
                
                <!-- Side Panel Analysis -->
                <div class="space-y-6">
                    <div class="bg-teal-50 p-5 rounded-xl border border-teal-100 shadow-sm">
                        <h4 class="font-bold text-teal-800 mb-2 flex items-center gap-2"><i data-lucide="cloud-sun" class="w-4 h-4"></i> Ph√¢n T√≠ch M√πa V·ª•</h4>
                        <ul class="text-sm text-teal-700 space-y-3">
                            <li class="flex items-start">
                                <span class="mr-2 mt-1">‚òÄÔ∏è</span>
                                <div><strong>M√πa Kh√¥ (T1-T4):</strong> Th·ªùi ƒëi·ªÉm "v√†ng" cho doanh thu. C√°c nƒÉm ƒë·ªÅu ƒë·∫°t ƒë·ªânh v√†o th√°ng 3-4 (>300 tri·ªáu/nh√† m√°y).</div>
                            </li>
                            <li class="flex items-start">
                                <span class="mr-2 mt-1">üåßÔ∏è</span>
                                <div><strong>M√πa M∆∞a (T6-T9):</strong> Doanh thu gi·∫£m m·∫°nh. Th√°ng 7-8 th∆∞·ªùng l√† v√πng tr≈©ng s·∫£n l∆∞·ª£ng.</div>
                            </li>
                        </ul>
                    </div>

                    <div class="bg-orange-50 p-5 rounded-xl border border-orange-100 shadow-sm">
                        <h4 class="font-bold text-orange-800 mb-2 flex items-center gap-2"><i data-lucide="alert-circle" class="w-4 h-4"></i> C·∫£nh B√°o B·∫•t Th∆∞·ªùng (2022)</h4>
                        <p class="text-sm text-orange-700 mb-2">Doanh thu c√°c th√°ng <strong>6, 7, 8</strong> nƒÉm 2022 gi·ªØ nguy√™n m·ª©c ~269 tri·ªáu.</p>
                        <p class="text-xs text-orange-600 italic">‚Üí D·∫•u hi·ªáu h·ªá th·ªëng b·ªã gi·ªõi h·∫°n c√¥ng su·∫•t ph√°t (Curtailment) ho·∫∑c ch·∫°m ng∆∞·ª°ng c√¥ng su·∫•t tr·∫°m.</p>
                    </div>
                </div>
            </div>

            <!-- Total Delta Chart (Full Width) -->
            <div class="bg-white p-6 rounded-xl shadow-sm border border-gray-200">
                <h2 class="text-lg font-bold mb-4 flex items-center gap-2 text-gray-800">
                    <i data-lucide="git-commit" class="w-5 h-5 text-accent2"></i> 
                    Bi·ªÉu ƒë·ªì Delta T·ªïng h·ª£p (Bi·∫øn ƒë·ªông C·∫£ c·ª•m 3 Nh√† m√°y)
                </h2>
                <div class="h-80"><canvas id="chart-total-delta-line"></canvas></div>
            </div>


            <!-- 3. SECTION: SO S√ÅNH HI·ªÜU QU·∫¢ (UPDATED LAYOUT WITH TABLE) -->
            <div class="grid grid-cols-1 lg:grid-cols-2 gap-6">
                <!-- Comparison Chart & Table Container -->
                <div class="lg:col-span-2 bg-white p-6 rounded-xl shadow-sm border border-gray-200">
                    <h2 class="text-lg font-bold mb-6 flex items-center gap-2 text-gray-800">
                        <i data-lucide="pie-chart" class="w-5 h-5 text-secondary"></i> 
                        So s√°nh Hi·ªáu qu·∫£ T·ªïng h·ª£p (2022-2025)
                    </h2>
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-8 items-center">
                        <div class="h-64 w-full">
                            <canvas id="chart-comparison"></canvas>
                        </div>
                        <div>
                            <table class="w-full text-sm text-left text-slate-600 border border-gray-100 rounded-lg overflow-hidden">
                                <thead class="text-xs text-slate-700 uppercase bg-slate-50">
                                    <tr>
                                        <th class="px-4 py-3 bg-gray-100">C√¥ng Ty</th>
                                        <th class="px-4 py-3 bg-gray-100 text-right">T·ªïng Thu (22-25)</th>
                                        <th class="px-4 py-3 bg-gray-100 text-right">T·ª∑ tr·ªçng</th>
                                    </tr>
                                </thead>
                                <tbody id="comparison-table-body">
                                    <!-- Populated by JS -->
                                </tbody>
                            </table>
                            <p class="text-xs text-slate-400 mt-4 italic">* S·ªë li·ªáu t·ªïng h·ª£p ch√≠nh x√°c t·ª´ b√°o c√°o quy·∫øt to√°n 4 nƒÉm.</p>
                        </div>
                    </div>
                </div>
            </div>

            <!-- 4. SECTION: FINANCIAL & RISKS (UPDATED) -->
            <div class="grid grid-cols-1 lg:grid-cols-3 gap-6">
                <!-- Financial ROI (Left - 2 Cols) -->
                <div class="lg:col-span-2 bg-slate-800 rounded-xl p-6 shadow-lg text-white">
                    <h2 class="text-lg font-bold mb-6 flex items-center gap-2 text-teal-400">
                        <i data-lucide="dollar-sign" class="w-5 h-5"></i> 
                        D√≤ng ti·ªÅn T√≠ch l≈©y & ƒêi·ªÉm H√≤a v·ªën
                    </h2>
                    <div class="grid grid-cols-1 md:grid-cols-3 gap-6">
                        <div class="md:col-span-2 h-72">
                             <canvas id="chart-financial-roi"></canvas>
                        </div>
                        <div class="flex flex-col justify-center space-y-4">
                            <div class="bg-slate-700 p-4 rounded-lg border border-slate-600">
                                <p class="text-[10px] text-slate-400 uppercase tracking-wider">V·ªën ƒê·∫ßu T∆∞ (∆Ø·ªõc t√≠nh)</p>
                                <p class="text-xl font-bold text-white">~42 T·ª∑ VNƒê</p>
                            </div>
                            <div class="bg-slate-700 p-4 rounded-lg border border-slate-600">
                                <p class="text-[10px] text-slate-400 uppercase tracking-wider">Doanh Thu T√≠ch L≈©y</p>
                                <p class="text-xl font-bold text-green-400" id="fin-acc-revenue">...</p>
                                <p class="text-[10px] text-slate-400 mt-1">ƒê·∫øn cu·ªëi 2025</p>
                            </div>
                            <div class="bg-teal-900/50 p-4 rounded-lg border border-teal-500/50">
                                <p class="text-[10px] text-teal-300 uppercase tracking-wider">D·ª± Ki·∫øn H√≤a V·ªën</p>
                                <p class="text-lg font-bold text-white">Cu·ªëi nƒÉm 2025</p>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Risks Section (Right - 1 Col) -->
                 <div class="bg-white p-0 rounded-xl shadow-sm border border-gray-200 overflow-hidden flex flex-col">
                    <!-- Curtailment Risk -->
                    <div class="p-5 border-b border-gray-100 border-l-4 border-l-red-500 flex-1">
                        <div class="flex items-center mb-3">
                            <span class="text-xl mr-2">‚ö°</span>
                            <h3 class="font-bold text-gray-800">R·ªßi Ro Sa Th·∫£i & C·∫Øt Gi·∫£m</h3>
                        </div>
                        <div class="space-y-2 text-sm">
                            <div class="flex justify-between bg-red-50 p-2 rounded text-red-700">
                                <span>T·ªâ l·ªá c·∫Øt gi·∫£m</span>
                                <span class="font-bold">10% - 15%</span>
                            </div>
                            <div class="flex justify-between bg-red-50 p-2 rounded text-red-700">
                                <span>Gi·ªù cao ƒëi·ªÉm</span>
                                <span class="font-bold">10h - 13h</span>
                            </div>
                            <p class="text-xs text-gray-500 mt-2">ƒê·∫∑c bi·ªát cao v√†o m√πa m∆∞a khi ph·ª• t·∫£i th·∫•p.</p>
                        </div>
                    </div>

                    <!-- Maintenance -->
                    <div class="p-5 border-l-4 border-l-blue-500 flex-1">
                        <div class="flex items-center mb-3">
                            <span class="text-xl mr-2">üîß</span>
                            <h3 class="font-bold text-gray-800">B·∫£o Tr√¨ & Tu·ªïi Th·ªç</h3>
                        </div>
                        <ul class="text-xs space-y-3 text-gray-600">
                            <li class="relative pl-3">
                                <span class="absolute left-0 top-1.5 w-1.5 h-1.5 bg-blue-500 rounded-full"></span>
                                <strong>Inverter:</strong> Thay linh ki·ªán m·ªói 5 nƒÉm. ƒê·∫°i tu 2025-2026.
                            </li>
                            <li class="relative pl-3">
                                <span class="absolute left-0 top-1.5 w-1.5 h-1.5 bg-blue-500 rounded-full"></span>
                                <strong>T·∫•m Pin:</strong> Suy hao ~0.6%/nƒÉm. V·ªá sinh 2 l·∫ßn/th√°ng (M√πa kh√¥).
                            </li>
                        </ul>
                    </div>
                </div>
            </div>

            <!-- 5. SECTION: DELTA TABLE -->
             <div class="bg-white rounded-xl shadow-sm border border-gray-300 overflow-hidden mt-8">
                <div class="px-6 py-4 border-b flex justify-between items-center bg-teal-700">
                    <h2 class="text-lg font-bold text-white flex items-center gap-2">
                        <i data-lucide="activity" class="w-5 h-5"></i> Ph√¢n t√≠ch Bi·∫øn ƒë·ªông Delta (Theo C√¥ng ty)
                    </h2>
                    <span class="text-xs bg-white/20 text-white px-2 py-1 rounded">S·ªë li·ªáu chi ti·∫øt (ƒê∆°n v·ªã: VNƒê)</span>
                </div>
                <div class="overflow-x-auto">
                    <table class="w-full text-sm text-left">
                        <thead class="text-xs uppercase bg-slate-100 text-gray-700 font-bold border-b-2 border-gray-200">
                            <tr>
                                <th class="px-6 py-3 w-32 border-r">NƒÉm</th>
                                <th class="px-6 py-3 w-16 text-center border-r hidden">Th√°ng</th>
                                <th class="px-6 py-3 text-right text-gray-600 border-r">2023 vs 2022</th>
                                <th class="px-6 py-3 text-right text-gray-600 border-r">2024 vs 2023</th>
                                <th class="px-6 py-3 text-right text-gray-600 border-r">2025 vs 2024</th>
                                <th class="px-6 py-3 text-right text-gray-600">2025 vs 2022</th>
                            </tr>
                        </thead>
                        <tbody id="delta-table-body"></tbody>
                        <tfoot id="delta-table-footer" class="bg-gray-100 font-bold text-gray-800 border-t-2 border-gray-300"></tfoot>
                    </table>
                </div>
                <div class="p-3 bg-gray-50 text-xs text-gray-500 italic border-t">
                    * Ghi ch√∫: C·ªôt so s√°nh v·ªõi nƒÉm 2025 (2025vs2024, 2025vs2022) s·ª≠ d·ª•ng s·ªë li·ªáu l≈©y k·∫ø 11 th√°ng (YTD) ƒë·ªÉ ƒë·∫£m b·∫£o t√≠nh ch√≠nh x√°c, do th√°ng 12/2025 ch∆∞a c√≥ d·ªØ li·ªáu.
                </div>
            </div>

            <!-- Main Data Table -->
            <div class="bg-white rounded-xl shadow-sm border border-gray-300 overflow-hidden mt-8">
                <div class="px-6 py-4 border-b flex justify-between items-center bg-gray-800">
                    <h2 class="text-lg font-bold text-white flex items-center gap-2">
                        <i data-lucide="table" class="w-5 h-5"></i> B·∫£ng D·ªØ li·ªáu Chi ti·∫øt (2022 - 2025)
                    </h2>
                    <span class="text-xs bg-white/20 text-white px-2 py-1 rounded">Click v√†o nƒÉm ƒë·ªÉ xem chi ti·∫øt</span>
                </div>
                <div class="overflow-x-auto max-h-96">
                    <table class="w-full text-sm text-left" id="main-data-table">
                        <thead class="text-xs uppercase bg-gray-100 text-gray-700 sticky top-0">
                            <tr>
                                <th class="px-6 py-3">Th·ªùi gian</th>
                                <th class="px-6 py-3 text-right">√Ånh Quang</th>
                                <th class="px-6 py-3 text-right">Duy Ti√™n</th>
                                <th class="px-6 py-3 text-right">Khoa Vi·ªát</th>
                                <th class="px-6 py-3 text-right font-bold">T·ªïng c·ªông</th>
                            </tr>
                        </thead>
                        <tbody id="main-table-body"></tbody>
                    </table>
                </div>
            </div>

        </div>

        <!-- ANALYSIS TAB -->
        <div id="tab-analysis" class="space-y-12 hidden-tab animate-fade-in">
            <!-- √Ånh Quang Analysis -->
            <div class="border-t border-gray-300 pt-6">
                <h3 class="text-lg font-bold mb-4 px-3 py-1 rounded w-fit text-white bg-primary">1. C√¥ng ty √Ånh Quang</h3>
                <div class="grid grid-cols-1 lg:grid-cols-2 gap-8">
                    <div class="bg-white p-5 rounded-xl border border-gray-300">
                        <h4 class="font-bold mb-4">Bi·ªÉu ƒë·ªì Doanh thu (√Ånh Quang)</h4>
                        <div class="h-72"><canvas id="chart-aq-revenue"></canvas></div>
                    </div>
                    <div>
                         <div class="bg-white p-5 rounded-xl border border-gray-300 mb-6">
                            <h4 class="font-bold mb-4">Bi·ªÉu ƒë·ªì Delta (√Ånh Quang)</h4>
                            <div class="h-64"><canvas id="chart-aq-delta"></canvas></div>
                         </div>
                    </div>
                </div>
            </div>

             <!-- Duy Ti√™n Analysis -->
             <div class="border-t border-gray-300 pt-6">
                <h3 class="text-lg font-bold mb-4 px-3 py-1 rounded w-fit text-white bg-primary">2. C√¥ng ty Duy Ti√™n</h3>
                <div class="grid grid-cols-1 lg:grid-cols-2 gap-8">
                    <div class="bg-white p-5 rounded-xl border border-gray-300">
                        <h4 class="font-bold mb-4">Bi·ªÉu ƒë·ªì Doanh thu (Duy Ti√™n)</h4>
                        <div class="h-72"><canvas id="chart-dt-revenue"></canvas></div>
                    </div>
                    <div>
                         <div class="bg-white p-5 rounded-xl border border-gray-300 mb-6">
                            <h4 class="font-bold mb-4">Bi·ªÉu ƒë·ªì Delta (Duy Ti√™n)</h4>
                            <div class="h-64"><canvas id="chart-dt-delta"></canvas></div>
                         </div>
                    </div>
                </div>
            </div>

            <!-- Khoa Vi·ªát Analysis -->
            <div class="border-t border-gray-300 pt-6">
                <h3 class="text-lg font-bold mb-4 px-3 py-1 rounded w-fit text-white bg-primary">3. C√¥ng ty Khoa Vi·ªát</h3>
                <div class="grid grid-cols-1 lg:grid-cols-2 gap-8">
                    <div class="bg-white p-5 rounded-xl border border-gray-300">
                        <h4 class="font-bold mb-4">Bi·ªÉu ƒë·ªì Doanh thu (Khoa Vi·ªát)</h4>
                        <div class="h-72"><canvas id="chart-kv-revenue"></canvas></div>
                    </div>
                    <div>
                         <div class="bg-white p-5 rounded-xl border border-gray-300 mb-6">
                            <h4 class="font-bold mb-4">Bi·ªÉu ƒë·ªì Delta (Khoa Vi·ªát)</h4>
                            <div class="h-64"><canvas id="chart-kv-delta"></canvas></div>
                         </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- STRATEGY TAB -->
        <div id="tab-strategy" class="hidden-tab animate-fade-in">
            <div class="max-w-4xl mx-auto bg-white p-8 rounded-xl border border-gray-300 shadow-sm">
                <h2 class="text-2xl font-bold mb-4 text-gray-800">Chi·∫øn l∆∞·ª£c Qu·∫£n tr·ªã D√†i h·∫°n</h2>
                <div class="space-y-4 text-gray-600">
                    <p>D·ª±a tr√™n ph√¢n t√≠ch s·ªë li·ªáu th·ª±c t·∫ø, c√°c h√†nh ƒë·ªông khuy·∫øn ngh·ªã bao g·ªìm:</p>
                    <ul class="list-disc pl-5 space-y-2">
                        <li><b>M√πa v·ª•:</b> T·∫≠p trung t·ªëi ƒëa ngu·ªìn l·ª±c b·∫£o tr√¨ v√†o th√°ng 11-12 ƒë·ªÉ ƒë√≥n ƒë·ªânh s·∫£n l∆∞·ª£ng th√°ng 3-4 nƒÉm sau.</li>
                        <li><b>T√†i ch√≠nh:</b> V·ªõi d√≤ng ti·ªÅn r√≤ng ·ªïn ƒë·ªãnh (ƒë√£ qua ƒëi·ªÉm h√≤a v·ªën), n√™n c√¢n nh·∫Øc t√°i ƒë·∫ßu t∆∞ v√†o h·ªá th·ªëng Robot v·ªá sinh ƒë·ªÉ gi·∫£m chi ph√≠ nh√¢n c√¥ng v√† tƒÉng s·∫£n l∆∞·ª£ng m√πa b·ª•i (T1-T4).</li>
                    </ul>
                </div>
            </div>
        </div>

    </main>

    <!-- LOGIC SCRIPT -->
    <script>
        // --- 1. CONFIG & REAL DATA FROM EXCEL ---
        const companies = ['√Ånh Quang', 'Duy Ti√™n', 'Khoa Vi·ªát'];
        const COLORS = {
            primary: '#009BB3', secondary: '#CBDAA4', accent1: '#DFE583', accent2: '#F36859', neutral: '#CCCCCC'
        };

        // NEW: EXACT DATA FROM USER IMAGE (Updated)
        const REAL_DATA = {
            '√Ånh Quang': {
                2022: [262952444, 252743531, 308893847, 288858725, 235423065, 265708228, 265708228, 217432480, 201584179, 208787952, 216293278, 227515667],
                2023: [236882007, 228663525, 326024048, 280005878, 269179097, 218184872, 208954179, 187901534, 203487541, 198087126, 226588841, 249487197],
                2024: [278904398, 249754660, 313341331, 320489515, 275691925, 241153523, 167894891, 244884137, 190760012, 204162588, 223640364, 222880424],
                2025: [265496396, 241786170, 302346672, 318589509, 285753698, 196973028, 158748629, 218569218, 174460755, 211700806, 206310016, 0]
            },
            'Duy Ti√™n': {
                2022: [260750559, 252039907, 313547540, 293717083, 238304574, 269125832, 269125832, 219442835, 204733736, 213646311, 219978930, 232374026],
                2023: [236506617, 232527746, 335005750, 286724748, 276246095, 224277112, 215414169, 194908401, 209398517, 201983628, 229767566, 253691317],
                2024: [282565926, 253241316, 318762379, 327605315, 282047786, 247647554, 172281816, 250894570, 194248827, 207234731, 226783751, 225367500],
                2025: [266236308, 244252544, 306469040, 326129568, 288572411, 202716157, 163117635, 224735154, 179499205, 216034578, 211559871, 0]
            },
            'Khoa Vi·ªát': {
                2022: [260836607, 255088945, 312509200, 293267869, 237936009, 269159338, 269159338, 218471163, 204365171, 212105038, 219208293, 231469366],
                2023: [238895465, 231657426, 332742918, 284914483, 273008505, 221387650, 212577242, 192276554, 207074288, 200958233, 230177724, 252836821],
                2024: [281978700, 251928693, 316933774, 325187325, 280009765, 245264107, 170934650, 249098349, 193350716, 207787414, 226541952, 225712927],
                2025: [266342010, 244182076, 305059684, 323028983, 288678113, 200778291, 161990149, 223114394, 178019381, 215787941, 210432385, 0]
            }
        };

        // KPI Calculated from NEW REAL DATA
        const totalRevenue = Object.values(REAL_DATA).reduce((acc, company) => {
            return acc + Object.values(company).reduce((sum, yearArr) => sum + yearArr.reduce((a,b)=>a+b, 0), 0);
        }, 0);

        // Formatters
        const formatMoney = (val) => new Intl.NumberFormat('vi-VN').format((val/1000000).toFixed(0)) + ' tr';
        const formatCurrencyFull = (val) => new Intl.NumberFormat('vi-VN', { style: 'currency', currency: 'VND' }).format(val);
        const formatNumber = (val) => new Intl.NumberFormat('vi-VN').format(val);

        // --- 2. DATA PROCESSING ---
        
        // Calculated Aggregate Data from REAL_DATA
        const getMonthlyTotal = () => {
             return Array.from({length: 12}, (_, i) => {
                let y22=0, y23=0, y24=0, y25=0;
                companies.forEach(c => {
                    y22 += REAL_DATA[c][2022][i] || 0;
                    y23 += REAL_DATA[c][2023][i] || 0;
                    y24 += REAL_DATA[c][2024][i] || 0;
                    y25 += REAL_DATA[c][2025][i] || 0;
                });
                return { label: `T${i+1}`, 2022: y22, 2023: y23, 2024: y24, 2025: y25 };
            });
        };

        const getCompanyTotal = () => {
            const result = {};
            companies.forEach(c => {
                result[c] = Object.values(REAL_DATA[c]).reduce((sum, arr) => sum + arr.reduce((a,b)=>a+b, 0), 0);
            });
            return result;
        };

        // --- 3. CHART RENDERING ---
        
        // 3.1 Total Revenue (LINE CHART) - SMOOTH & INTERACTIVE
        const renderTotalRevenueChart = () => {
            const ctx = document.getElementById('chart-total-revenue-line').getContext('2d');
            const data = getMonthlyTotal();
            const labels = data.map(d => d.label);
            
            new Chart(ctx, {
                type: 'line',
                data: {
                    labels: labels,
                    datasets: [
                        { label: '2025 (Hi·ªán t·∫°i)', data: data.map(d => d[2025]), borderColor: COLORS.accent2, borderWidth: 3, tension: 0.4, pointRadius: 4, pointHoverRadius: 6, backgroundColor: COLORS.accent2 },
                        { label: '2024', data: data.map(d => d[2024]), borderColor: COLORS.primary, borderWidth: 2, tension: 0.4, pointRadius: 3, pointHoverRadius: 5, backgroundColor: COLORS.primary },
                        { label: '2023', data: data.map(d => d[2023]), borderColor: COLORS.secondary, borderWidth: 2, tension: 0.4, pointRadius: 3, pointHoverRadius: 5, backgroundColor: COLORS.secondary },
                        { label: '2022', data: data.map(d => d[2022]), borderColor: COLORS.neutral, borderWidth: 2, borderDash: [5,5], tension: 0.4, pointRadius: 2 }
                    ]
                },
                options: {
                    responsive: true, maintainAspectRatio: false,
                    interaction: { mode: 'index', intersect: false },
                    plugins: { legend: { position: 'top' }, datalabels: { display: false } },
                    scales: { y: { beginAtZero: false, grid: { borderDash: [2, 2] } } }
                }
            });
        };

        // 3.1.2 Total Delta Chart (Calculated from Real Data) - SMOOTH
        const renderTotalDeltaChart = () => {
            const ctx = document.getElementById('chart-total-delta-line').getContext('2d');
            const monthlyTotal = getMonthlyTotal();
            const labels = monthlyTotal.map(m => m.label);
            
            const d23_22 = monthlyTotal.map(m => m[2023] - m[2022]);
            const d24_23 = monthlyTotal.map(m => m[2024] - m[2023]);
            const d25_24 = monthlyTotal.map(m => m[2025] - m[2024]);
            const d25_22 = monthlyTotal.map(m => m[2025] - m[2022]);

            new Chart(ctx, {
                type: 'line',
                data: {
                    labels: labels,
                    datasets: [
                        { label: '23 vs 22', data: d23_22, borderColor: COLORS.neutral, borderWidth: 1, tension: 0.4 },
                        { label: '24 vs 23', data: d24_23, borderColor: COLORS.secondary, borderWidth: 2, tension: 0.4 },
                        { label: '25 vs 24', data: d25_24, borderColor: COLORS.primary, borderWidth: 2, tension: 0.4 },
                        { label: '25 vs 22 (3y)', data: d25_22, borderColor: COLORS.accent2, borderWidth: 3, tension: 0.4 }
                    ]
                },
                options: {
                    responsive: true, maintainAspectRatio: false,
                    interaction: { mode: 'index', intersect: false },
                    plugins: { legend: { position: 'top' }, datalabels: { display: false } },
                    scales: { y: { ticks: { callback: (val) => (val/1000000).toFixed(0) } } }
                }
            });
        };

        // 3.2 Comparison Chart & Table Population
        const renderComparisonChart = () => {
            const ctx = document.getElementById('chart-comparison').getContext('2d');
            const totals = getCompanyTotal();
            const grandTotal = Object.values(totals).reduce((a,b) => a+b, 0);

            // Populate Table
            const tbody = document.getElementById('comparison-table-body');
            const sortedKeys = Object.keys(totals).sort((a,b) => totals[b] - totals[a]);
            
            sortedKeys.forEach(company => {
                const val = totals[company];
                const percentage = ((val/grandTotal)*100).toFixed(1);
                const row = document.createElement('tr');
                row.className = "border-b border-gray-50 hover:bg-gray-50 transition-colors";
                row.innerHTML = `
                    <td class="px-4 py-3 font-medium text-gray-800">${company}</td>
                    <td class="px-4 py-3 text-right font-mono text-primary">${formatMoney(val)}</td>
                    <td class="px-4 py-3 text-right text-xs text-gray-500">${percentage}%</td>
                `;
                tbody.appendChild(row);
            });
            
            // Render Chart
            new Chart(ctx, {
                type: 'bar',
                data: {
                    labels: Object.keys(totals),
                    datasets: [{
                        label: 'T·ªïng Doanh Thu (VNƒê)',
                        data: Object.values(totals),
                        backgroundColor: [COLORS.primary, COLORS.secondary, COLORS.accent2],
                        borderRadius: 8,
                        barThickness: 40
                    }]
                },
                options: {
                    responsive: true, maintainAspectRatio: false,
                    indexAxis: 'y',
                    plugins: { 
                        legend: { display: false },
                        datalabels: {
                            color: '#fff', anchor: 'end', align: 'start', offset: -50,
                            formatter: (value) => (value/1000000000).toFixed(2) + ' T·ª∑', 
                            font: { weight: 'bold' }
                        }
                    },
                    scales: { x: { display: false, max: Math.max(...Object.values(totals)) * 1.2 }, y: { grid: { display: false } } },
                }
            });
        };

        // 3.3 Financial ROI Chart (VAT 8% Logic)
        const renderFinancialChart = () => {
            const ctx = document.getElementById('chart-financial-roi').getContext('2d');
            const labels = ['2020', '2021', '2022', '2023', '2024', '2025'];
            
            const initialInv = -42000000000;
            // Rev 2021 = 10 Billion. Break-even rev = 10B / 1.08.
            const cf2021 = 10000000000 / 1.08;
            
            const getRev = (y) => {
               return Object.values(REAL_DATA).reduce((acc, c) => acc + c[y].reduce((a,b)=>a+b,0), 0); 
            };
            
            const cf22 = getRev(2022) / 1.08;
            const cf23 = getRev(2023) / 1.08;
            const cf24 = getRev(2024) / 1.08;
            const cf25 = getRev(2025) / 1.08;

            const cashflow = [
                initialInv,
                initialInv + cf2021,
                initialInv + cf2021 + cf22,
                initialInv + cf2021 + cf22 + cf23,
                initialInv + cf2021 + cf22 + cf23 + cf24,
                initialInv + cf2021 + cf22 + cf23 + cf24 + cf25
            ];

            // Update Stats in DOM
            const totalAccumulated = initialInv + cashflow[5]; // Should be close to 0 or positive
            // Just display positive revenue accumulated
            const accRevenue = cf2021 + cf22 + cf23 + cf24 + cf25;
            document.getElementById('fin-acc-revenue').innerText = '~' + (accRevenue/1000000000).toFixed(1) + ' T·ª∑ VNƒê';

            new Chart(ctx, {
                type: 'line',
                data: {
                    labels: labels,
                    datasets: [{
                        label: 'D√≤ng ti·ªÅn T√≠ch l≈©y (Sau VAT)',
                        data: cashflow,
                        borderColor: '#2dd4bf', // Teal 400
                        backgroundColor: 'rgba(45, 212, 191, 0.1)',
                        borderWidth: 3,
                        pointBackgroundColor: '#fff',
                        pointBorderColor: '#2dd4bf',
                        pointRadius: 5,
                        fill: true,
                        tension: 0.4,
                    }]
                },
                options: {
                    responsive: true, maintainAspectRatio: false,
                    plugins: { legend: { display: false }, datalabels: { display: false } },
                    scales: { 
                        y: { 
                            ticks: { callback: (val) => (val/1000000000).toFixed(0) + ' t·ª∑', color: '#94a3b8' },
                            grid: { color: '#334155' }
                        },
                        x: { ticks: { color: '#94a3b8' }, grid: { display: false } }
                    }
                }
            });
        };

        // 3.4 Analysis Line Charts
        const renderStandardLineChart = (canvasId, company, type='revenue') => {
            const ctx = document.getElementById(canvasId).getContext('2d');
            const data = REAL_DATA[company];
            const labels = Array.from({length: 12}, (_, i) => `T${i+1}`);
            let datasets = [];
            
            if (type === 'revenue') {
                datasets = [
                    { label: '2022', data: data[2022], borderColor: COLORS.neutral, borderDash: [5,5], pointRadius: 0, tension: 0.4 },
                    { label: '2023', data: data[2023], borderColor: COLORS.secondary, pointRadius: 2, tension: 0.4 },
                    { label: '2024', data: data[2024], borderColor: COLORS.primary, pointRadius: 2, tension: 0.4 },
                    { label: '2025', data: data[2025], borderColor: COLORS.accent2, pointRadius: 4, tension: 0.4 }
                ];
            } else {
                const d23_22 = data[2023].map((v, i) => v - data[2022][i]);
                const d24_23 = data[2024].map((v, i) => v - data[2023][i]);
                const d25_24 = data[2025].map((v, i) => v - data[2024][i]);
                const d25_22 = data[2025].map((v, i) => v - data[2022][i]);

                datasets = [
                    { label: '23 vs 22', data: d23_22, borderColor: COLORS.neutral, borderWidth: 1, tension: 0.4 },
                    { label: '24 vs 23', data: d24_23, borderColor: COLORS.secondary, borderWidth: 2, tension: 0.4 },
                    { label: '25 vs 24', data: d25_24, borderColor: COLORS.primary, borderWidth: 2, tension: 0.4 },
                    { label: '25 vs 22 (3y)', data: d25_22, borderColor: COLORS.accent2, borderWidth: 3, tension: 0.4 }
                ];
            }

            new Chart(ctx, {
                type: 'line',
                data: { labels, datasets },
                options: {
                    responsive: true, maintainAspectRatio: false,
                    plugins: { legend: { position: 'bottom' }, datalabels: { display: false } },
                    scales: { y: { ticks: { callback: (val) => (val/1000000).toFixed(0) } } }
                }
            });
        };

        // --- 4. TABLE LOGIC (UPDATED WITH GRAND TOTAL) ---
        const renderDeltaTable = () => {
            const tbody = document.getElementById('delta-table-body');
            const tfoot = document.getElementById('delta-table-footer');
            tbody.innerHTML = "";
            tfoot.innerHTML = "";

            // Accumulators for Grand Total
            let total23_22 = 0;
            let total24_23 = 0;
            let total25_24 = 0;
            let total25_22 = 0;

            companies.forEach(company => {
                const data = REAL_DATA[company];
                const d23_22 = data[2023].map((v, i) => v - data[2022][i]);
                const d24_23 = data[2024].map((v, i) => v - data[2023][i]);
                const d25_24 = data[2025].map((v, i) => v - data[2024][i]);
                const d25_22 = data[2025].map((v, i) => v - data[2022][i]);

                const sum = (arr) => arr.reduce((a,b)=>a+b,0);
                const sumYTD = (arr) => arr.slice(0, 11).reduce((a,b)=>a+b,0);

                const deltaYear23_22 = sum(data[2023]) - sum(data[2022]);
                const deltaYear24_23 = sum(data[2024]) - sum(data[2023]);
                
                // IMPORTANT LOGIC UPDATE: Use YTD (11 months) for 2025 comparisons to match image data
                const deltaYear25_24 = sumYTD(data[2025]) - sumYTD(data[2024]);
                const deltaYear25_22 = sumYTD(data[2025]) - sumYTD(data[2022]);

                // Accumulate Grand Totals
                total23_22 += deltaYear23_22;
                total24_23 += deltaYear24_23;
                total25_24 += deltaYear25_24;
                total25_22 += deltaYear25_22;

                // Render Company Header Row
                const header = document.createElement('tr');
                header.className = "bg-gray-50 border-b border-gray-200 cursor-pointer font-bold hover:bg-blue-50";
                header.innerHTML = `
                    <td class="px-6 py-3 text-primary flex items-center gap-2 border-r"><i data-lucide="chevron-down" class="w-4 h-4"></i> ${company}</td>
                    <td class="px-6 py-3 w-16 text-center border-r hidden"></td>
                    <td class="text-right px-6 text-gray-700 border-r">${formatNumber(deltaYear23_22)}</td>
                    <td class="text-right px-6 text-gray-700 border-r">${formatNumber(deltaYear24_23)}</td>
                    <td class="text-right px-6 text-gray-700 border-r">${formatNumber(deltaYear25_24)}</td>
                    <td class="text-right px-6 text-gray-700">${formatNumber(deltaYear25_22)}</td>
                `;
                
                const detailsFrag = document.createDocumentFragment();
                for(let i=0; i<12; i++) {
                    const row = document.createElement('tr');
                    row.className = `border-b border-gray-100 bg-white group-delta-${company.replace(/\s/g,'')}`;
                    const fmt = (val) => `<span class="${val>0?'text-black':(val<0?'text-black':'text-gray-400')}">${formatNumber(val)}</span>`;
                    
                    // Logic to handle empty cells for December 2025
                    let val25_24 = fmt(d25_24[i]);
                    let val25_22 = fmt(d25_22[i]);
                    
                    if (i === 11) { // December
                        val25_24 = '<span class="text-gray-300">-</span>';
                        val25_22 = '<span class="text-gray-300">-</span>';
                    }

                    row.innerHTML = `
                        <td class="px-6 py-2 pl-12 text-gray-500 text-xs border-r">T${i+1 < 10 ? '0'+(i+1) : i+1}</td>
                        <td class="px-6 py-2 text-gray-700 font-bold text-xs border-r hidden"></td>
                        <td class="text-right px-6 font-mono text-xs border-r text-gray-600">${fmt(d23_22[i])}</td>
                        <td class="text-right px-6 font-mono text-xs border-r text-gray-600">${fmt(d24_23[i])}</td>
                        <td class="text-right px-6 font-mono text-xs border-r text-gray-600">${val25_24}</td>
                        <td class="text-right px-6 font-mono text-xs text-gray-600">${val25_22}</td>
                    `;
                    detailsFrag.appendChild(row);
                }
                header.onclick = () => { document.querySelectorAll(`.group-delta-${company.replace(/\s/g,'')}`).forEach(r => r.style.display = r.style.display === 'none' ? 'table-row' : 'none'); };
                tbody.appendChild(header);
                tbody.appendChild(detailsFrag);
            });

            // Render Grand Total Footer Row
            const footerRow = document.createElement('tr');
            footerRow.innerHTML = `
                <td class="px-6 py-4 uppercase border-r">T·ªïng s·ªë 3 c√¥ng ty</td>
                <td class="px-6 py-3 w-16 text-center border-r hidden"></td>
                <td class="text-right px-6 border-r">${formatNumber(total23_22)}</td>
                <td class="text-right px-6 border-r">${formatNumber(total24_23)}</td>
                <td class="text-right px-6 border-r">${formatNumber(total25_24)}</td>
                <td class="text-right px-6">${formatNumber(total25_22)}</td>
            `;
            tfoot.appendChild(footerRow);
        };

        const renderMainTable = () => {
            const tbody = document.getElementById('main-table-body');
            const years = [2025, 2024, 2023, 2022];
            years.forEach(year => {
                const aqTotal = REAL_DATA['√Ånh Quang'][year].reduce((a,b)=>a+b,0);
                const dtTotal = REAL_DATA['Duy Ti√™n'][year].reduce((a,b)=>a+b,0);
                const kvTotal = REAL_DATA['Khoa Vi·ªát'][year].reduce((a,b)=>a+b,0);
                const yearTotal = aqTotal + dtTotal + kvTotal;

                const header = document.createElement('tr');
                header.className = "bg-secondary/30 cursor-pointer hover:bg-secondary/50 font-bold border-b border-gray-200";
                header.innerHTML = `<td class="px-6 py-3 flex gap-2"><i data-lucide="chevron-down" class="w-4 h-4"></i> NƒÉm ${year}</td><td class="text-right px-6">${formatMoney(aqTotal)}</td><td class="text-right px-6">${formatMoney(dtTotal)}</td><td class="text-right px-6">${formatMoney(kvTotal)}</td><td class="text-right px-6 text-primary">${formatMoney(yearTotal)}</td>`;
                
                const detailsFrag = document.createDocumentFragment();
                for(let m=0; m<12; m++) {
                    const aq = REAL_DATA['√Ånh Quang'][year][m];
                    const dt = REAL_DATA['Duy Ti√™n'][year][m];
                    const kv = REAL_DATA['Khoa Vi·ªát'][year][m];
                    const row = document.createElement('tr');
                    row.className = `border-b border-gray-100 bg-white group-year-${year}`;
                    row.innerHTML = `<td class="px-6 py-2 pl-12 text-gray-500 text-xs">T${m+1}</td><td class="text-right px-6 font-mono text-xs text-gray-600">${formatCurrencyFull(aq)}</td><td class="text-right px-6 font-mono text-xs text-gray-600">${formatCurrencyFull(dt)}</td><td class="text-right px-6 font-mono text-xs text-gray-600">${formatCurrencyFull(kv)}</td><td class="text-right px-6 font-mono text-xs font-medium">${formatCurrencyFull(aq+dt+kv)}</td>`;
                    detailsFrag.appendChild(row);
                }
                header.onclick = () => { document.querySelectorAll(`.group-year-${year}`).forEach(r => r.style.display = r.style.display === 'none' ? 'table-row' : 'none'); };
                tbody.appendChild(header);
                tbody.appendChild(detailsFrag);
            });
            [2024, 2023, 2022].forEach(y => document.querySelectorAll(`.group-year-${y}`).forEach(r => r.style.display = 'none'));
        };

        // --- 5. INITIALIZATION ---
        function switchTab(tabId) {
            ['dashboard', 'analysis', 'strategy'].forEach(id => {
                document.getElementById(`tab-${id}`).classList.add('hidden-tab');
                document.getElementById(`btn-${id}`).classList.replace('active-tab-btn', 'inactive-tab-btn');
            });
            document.getElementById(`tab-${tabId}`).classList.remove('hidden-tab');
            document.getElementById(`btn-${tabId}`).classList.replace('inactive-tab-btn', 'active-tab-btn');
        }

        document.addEventListener('DOMContentLoaded', () => {
            lucide.createIcons();
            document.getElementById('kpi-total-revenue').innerText = formatMoney(totalRevenue);

            Chart.defaults.font.family = 'sans-serif';
            Chart.defaults.color = '#64748b';

            renderTotalRevenueChart();
            renderTotalDeltaChart(); // NEW
            renderComparisonChart();
            renderFinancialChart();
            
            ['√Ånh Quang', 'Duy Ti√™n', 'Khoa Vi·ªát'].forEach(c => {
                let code = c === '√Ånh Quang' ? 'aq' : (c === 'Duy Ti√™n' ? 'dt' : 'kv');
                renderStandardLineChart(`chart-${code}-revenue`, c, 'revenue');
                renderStandardLineChart(`chart-${code}-delta`, c, 'delta');
            });

            renderMainTable();
            renderDeltaTable();
        });
    </script>
</body>
</html>
