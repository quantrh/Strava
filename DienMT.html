<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Solar Monitor Pro - Pleiku Operation Center</title>
    
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    
    <!-- Chart.js -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <!-- Chart.js Data Labels Plugin -->
    <script src="https://cdn.jsdelivr.net/npm/chartjs-plugin-datalabels@2.0.0"></script>
    
    <!-- Lucide Icons -->
    <script src="https://unpkg.com/lucide@latest"></script>

    <style>
        /* Custom Palette configuration */
        :root {
            --color-primary: #009BB3;   /* Teal/Blue */
            --color-secondary: #CBDAA4; /* Sage Green */
            --color-accent1: #DFE583;   /* Lime */
            --color-accent2: #F36859;   /* Coral Red */
            --color-neutral: #CCCCCC;
            --color-text: #374151;
        }
        .bg-primary { background-color: var(--color-primary); }
        .text-primary { color: var(--color-primary); }
        .text-accent2 { color: var(--color-accent2); }
        
        /* Custom Scrollbar */
        ::-webkit-scrollbar { width: 6px; height: 6px; }
        ::-webkit-scrollbar-track { background: #f1f1f1; }
        ::-webkit-scrollbar-thumb { background: #c1c1c1; border-radius: 4px; }
        ::-webkit-scrollbar-thumb:hover { background: #a8a8a8; }
        
        /* Hide scrollbar for nav on mobile but keep functionality */
        .no-scrollbar::-webkit-scrollbar { display: none; }
        .no-scrollbar { -ms-overflow-style: none; scrollbar-width: none; }

        .hidden-tab { display: none; }
        .active-tab-btn { background-color: white; color: var(--color-primary); box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1); font-weight: 700; }
        .inactive-tab-btn { color: #E0F2FE; }
        .inactive-tab-btn:hover { background-color: rgba(255, 255, 255, 0.1); }
        
        @keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }
        .animate-fade-in { animation: fadeIn 0.4s ease-out forwards; }

        /* Mobile specific adjustments */
        @media (max-width: 640px) {
            .chart-container { height: 250px !important; }
            h1 { font-size: 1.1rem !important; }
            h2 { font-size: 1.1rem !important; }
        }
    </style>
</head>
<body class="bg-slate-50 font-sans text-gray-900 min-h-screen pb-16 md:pb-12">

    <!-- Header - Responsive Modified -->
    <header class="text-white shadow-xl sticky top-0 z-50 transition-all duration-300" style="background: linear-gradient(to right, #1e293b, var(--color-primary));">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-3 md:h-16 flex flex-col md:flex-row items-center justify-between gap-3 md:gap-0">
            <!-- Logo Section -->
            <div class="flex items-center gap-3 w-full md:w-auto">
                <div class="bg-yellow-400 p-1.5 rounded-full shadow-lg shrink-0"><i data-lucide="sun" class="w-5 h-5 md:w-6 md:h-6 text-indigo-900"></i></div>
                <div class="flex flex-col">
                    <h1 class="text-lg md:text-xl font-bold leading-tight">Solar Monitor Pro</h1>
                    <p class="text-[10px] opacity-80 uppercase tracking-wide">Pleiku Operation Center</p>
                </div>
            </div>
            
            <!-- Nav Section - Scrollable on Mobile -->
            <nav class="w-full md:w-auto flex items-center space-x-1 bg-white/10 p-1 rounded-xl overflow-x-auto no-scrollbar whitespace-nowrap mask-linear-fade">
                <button onclick="switchTab('dashboard')" id="btn-dashboard" class="flex-1 md:flex-none px-4 py-2 rounded-lg text-sm font-medium transition-all active-tab-btn">T·ªïng quan</button>
                <button onclick="switchTab('analysis')" id="btn-analysis" class="flex-1 md:flex-none px-4 py-2 rounded-lg text-sm font-medium transition-all inactive-tab-btn">Ph√¢n t√≠ch</button>
                <button onclick="switchTab('strategy')" id="btn-strategy" class="flex-1 md:flex-none px-4 py-2 rounded-lg text-sm font-medium transition-all inactive-tab-btn">Chi·∫øn l∆∞·ª£c</button>
            </nav>
        </div>
    </header>

    <main class="max-w-7xl mx-auto px-3 sm:px-6 lg:px-8 py-6 md:py-8">
        
        <!-- ALERT: DATA UPDATE -->
        <div class="bg-green-50 border-l-4 border-green-400 p-3 md:p-4 mb-6 rounded-r shadow-sm">
            <div class="flex items-start md:items-center">
                <div class="flex-shrink-0 mt-0.5 md:mt-0">
                    <i data-lucide="database" class="h-5 w-5 text-green-600"></i>
                </div>
                <div class="ml-3">
                    <p class="text-sm text-green-800 leading-relaxed">
                        <span class="font-bold block md:inline">D·ªØ li·ªáu ƒë·ªìng b·ªô:</span> H·ªá th·ªëng ƒë√£ c·∫≠p nh·∫≠t s·ªë li·ªáu chi ti·∫øt 3 nh√† m√°y (√Ånh Quang, Duy Ti√™n, Khoa Vi·ªát) theo b√°o c√°o quy·∫øt to√°n m·ªõi nh·∫•t.
                    </p>
                </div>
            </div>
        </div>

        <!-- DASHBOARD TAB -->
        <div id="tab-dashboard" class="space-y-6 md:space-y-8 animate-fade-in">
            <!-- 1. KPI Cards - Grid optimized for mobile (2 cols on small screens) -->
            <div class="grid grid-cols-2 md:grid-cols-4 gap-3 md:gap-4">
                <div class="bg-white p-4 rounded-xl shadow-sm border border-gray-200 col-span-2 md:col-span-1">
                    <p class="text-[10px] md:text-xs font-bold text-gray-400 uppercase tracking-wider">T·ªïng Doanh Thu (22-25)</p>
                    <h3 class="text-xl md:text-2xl font-bold text-gray-800 mt-1" id="kpi-total-revenue">...</h3>
                    <div class="mt-2 text-xs text-green-600 flex items-center gap-1"><i data-lucide="trending-up" class="w-3 h-3"></i> S·ªë li·ªáu th·ª±c t·∫ø</div>
                </div>
                <div class="bg-white p-4 rounded-xl shadow-sm border border-gray-200">
                    <p class="text-[10px] md:text-xs font-bold text-gray-400 uppercase tracking-wider">Doanh thu TB/NƒÉm</p>
                    <h3 class="text-lg md:text-2xl font-bold text-gray-800 mt-1">~8.5 T·ª∑</h3>
                    <div class="mt-2 text-[10px] md:text-xs text-blue-600 truncate">ƒê·∫°t 98% k·∫ø ho·∫°ch</div>
                </div>
                <div class="bg-white p-4 rounded-xl shadow-sm border border-gray-200">
                    <p class="text-[10px] md:text-xs font-bold text-gray-400 uppercase tracking-wider">D√≤ng ti·ªÅn T√≠ch l≈©y</p>
                    <h3 class="text-lg md:text-2xl font-bold text-emerald-600 mt-1">D∆∞∆°ng (+)</h3>
                    <div class="mt-2 text-[10px] md:text-xs text-gray-500 truncate">Qua ƒëi·ªÉm h√≤a v·ªën</div>
                </div>
                <div class="bg-white p-4 rounded-xl shadow-sm border border-gray-200 col-span-2 md:col-span-1">
                    <p class="text-[10px] md:text-xs font-bold text-gray-400 uppercase tracking-wider">Tr·∫°ng th√°i Thi·∫øt b·ªã</p>
                    <h3 class="text-xl md:text-2xl font-bold text-gray-800 mt-1">·ªîn ƒë·ªãnh</h3>
                    <div class="mt-2 text-xs text-orange-500 flex items-center gap-1"><i data-lucide="alert-triangle" class="w-3 h-3"></i> L∆∞u √Ω m√πa m∆∞a T7-T8</div>
                </div>
            </div>

            <!-- 2. SECTION: DOANH THU & PH√ÇN T√çCH -->
            <div class="grid grid-cols-1 lg:grid-cols-3 gap-6">
                <!-- Chart Box -->
                <div class="lg:col-span-2 bg-white p-4 md:p-6 rounded-xl shadow-sm border border-gray-200">
                    <h2 class="text-base md:text-lg font-bold mb-4 flex items-center gap-2 text-gray-800">
                        <i data-lucide="activity" class="w-5 h-5 text-primary shrink-0"></i> 
                        Bi·ªÉu ƒë·ªì Bi·∫øn ƒë·ªông Doanh thu
                    </h2>
                    <div class="h-64 md:h-80 w-full"><canvas id="chart-total-revenue-line"></canvas></div>
                </div>
                
                <!-- Info Boxes -->
                <div class="space-y-4 md:space-y-6">
                    <div class="bg-teal-50 p-4 md:p-5 rounded-xl border border-teal-100 shadow-sm">
                        <h4 class="font-bold text-teal-800 mb-2 flex items-center gap-2 text-sm md:text-base"><i data-lucide="cloud-sun" class="w-4 h-4"></i> Ph√¢n T√≠ch M√πa V·ª•</h4>
                        <ul class="text-sm text-teal-700 space-y-3">
                            <li class="flex items-start">
                                <span class="mr-2 mt-0.5">‚òÄÔ∏è</span>
                                <div><strong>M√πa Kh√¥ (T1-T4):</strong> Th·ªùi ƒëi·ªÉm "v√†ng". ƒê·∫°t ƒë·ªânh v√†o th√°ng 3-4 (>300 tr/nh√† m√°y).</div>
                            </li>
                            <li class="flex items-start">
                                <span class="mr-2 mt-0.5">üåßÔ∏è</span>
                                <div><strong>M√πa M∆∞a (T6-T9):</strong> Gi·∫£m m·∫°nh. T7-T8 l√† v√πng tr≈©ng s·∫£n l∆∞·ª£ng.</div>
                            </li>
                        </ul>
                    </div>

                    <div class="bg-orange-50 p-4 md:p-5 rounded-xl border border-orange-100 shadow-sm">
                        <h4 class="font-bold text-orange-800 mb-2 flex items-center gap-2 text-sm md:text-base"><i data-lucide="alert-circle" class="w-4 h-4"></i> C·∫£nh B√°o (2022)</h4>
                        <p class="text-sm text-orange-700 mb-2">Doanh thu T6, T7, T8 nƒÉm 2022 gi·ªØ nguy√™n m·ª©c ~269 tri·ªáu.</p>
                        <p class="text-xs text-orange-600 italic">‚Üí D·∫•u hi·ªáu b·ªã gi·ªõi h·∫°n c√¥ng su·∫•t ph√°t (Curtailment).</p>
                    </div>
                </div>
            </div>

            <!-- Total Delta Chart -->
            <div class="bg-white p-4 md:p-6 rounded-xl shadow-sm border border-gray-200">
                <h2 class="text-base md:text-lg font-bold mb-4 flex items-center gap-2 text-gray-800">
                    <i data-lucide="git-commit" class="w-5 h-5 text-accent2 shrink-0"></i> 
                    Bi·ªÉu ƒë·ªì Delta T·ªïng h·ª£p
                </h2>
                <div class="h-64 md:h-80"><canvas id="chart-total-delta-line"></canvas></div>
            </div>

            <!-- 3. SECTION: SO S√ÅNH HI·ªÜU QU·∫¢ -->
            <div class="grid grid-cols-1 lg:grid-cols-2 gap-6">
                <div class="lg:col-span-2 bg-white p-4 md:p-6 rounded-xl shadow-sm border border-gray-200">
                    <h2 class="text-base md:text-lg font-bold mb-6 flex items-center gap-2 text-gray-800">
                        <i data-lucide="pie-chart" class="w-5 h-5 text-secondary shrink-0"></i> 
                        So s√°nh Hi·ªáu qu·∫£ (2022-2025)
                    </h2>
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-8 items-center">
                        <div class="h-56 md:h-64 w-full">
                            <canvas id="chart-comparison"></canvas>
                        </div>
                        <div class="overflow-x-auto">
                            <table class="w-full text-sm text-left text-slate-600 border border-gray-100 rounded-lg min-w-[300px]">
                                <thead class="text-xs text-slate-700 uppercase bg-slate-50">
                                    <tr>
                                        <th class="px-3 py-3 bg-gray-100">C√¥ng Ty</th>
                                        <th class="px-3 py-3 bg-gray-100 text-right">T·ªïng Thu</th>
                                        <th class="px-3 py-3 bg-gray-100 text-right">T·ª∑ tr·ªçng</th>
                                    </tr>
                                </thead>
                                <tbody id="comparison-table-body"></tbody>
                            </table>
                            <p class="text-xs text-slate-400 mt-4 italic text-center md:text-left">* S·ªë li·ªáu ch√≠nh x√°c t·ª´ b√°o c√°o quy·∫øt to√°n 4 nƒÉm.</p>
                        </div>
                    </div>
                </div>
            </div>

            <!-- 4. SECTION: FINANCIAL & RISKS -->
            <div class="grid grid-cols-1 lg:grid-cols-3 gap-6">
                <div class="lg:col-span-2 bg-slate-800 rounded-xl p-4 md:p-6 shadow-lg text-white">
                    <h2 class="text-base md:text-lg font-bold mb-6 flex items-center gap-2 text-teal-400">
                        <i data-lucide="dollar-sign" class="w-5 h-5"></i> 
                        D√≤ng ti·ªÅn & ƒêi·ªÉm H√≤a v·ªën
                    </h2>
                    <div class="grid grid-cols-1 md:grid-cols-3 gap-6">
                        <div class="md:col-span-2 h-64 md:h-72 order-2 md:order-1">
                             <canvas id="chart-financial-roi"></canvas>
                        </div>
                        <div class="flex flex-row md:flex-col justify-between md:justify-center gap-3 md:gap-4 order-1 md:order-2 overflow-x-auto pb-2 md:pb-0">
                            <div class="bg-slate-700 p-3 md:p-4 rounded-lg border border-slate-600 min-w-[120px] flex-1">
                                <p class="text-[9px] md:text-[10px] text-slate-400 uppercase tracking-wider">V·ªën ƒê·∫ßu T∆∞</p>
                                <p class="text-base md:text-xl font-bold text-white whitespace-nowrap">~42 T·ª∑</p>
                            </div>
                            <div class="bg-slate-700 p-3 md:p-4 rounded-lg border border-slate-600 min-w-[120px] flex-1">
                                <p class="text-[9px] md:text-[10px] text-slate-400 uppercase tracking-wider">L≈©y k·∫ø 2025</p>
                                <p class="text-base md:text-xl font-bold text-green-400 whitespace-nowrap" id="fin-acc-revenue">...</p>
                            </div>
                            <div class="bg-teal-900/50 p-3 md:p-4 rounded-lg border border-teal-500/50 min-w-[120px] flex-1">
                                <p class="text-[9px] md:text-[10px] text-teal-300 uppercase tracking-wider">H√≤a V·ªën</p>
                                <p class="text-base md:text-lg font-bold text-white whitespace-nowrap">Cu·ªëi 2025</p>
                            </div>
                        </div>
                    </div>
                </div>

                 <div class="bg-white p-0 rounded-xl shadow-sm border border-gray-200 overflow-hidden flex flex-col md:flex-row lg:flex-col">
                    <div class="p-4 md:p-5 border-b md:border-b-0 lg:border-b md:border-r lg:border-r-0 border-gray-100 border-l-4 border-l-red-500 flex-1">
                        <div class="flex items-center mb-3">
                            <span class="text-xl mr-2">‚ö°</span>
                            <h3 class="font-bold text-gray-800 text-sm md:text-base">R·ªßi Ro C·∫Øt Gi·∫£m</h3>
                        </div>
                        <div class="space-y-2 text-sm">
                            <div class="flex justify-between bg-red-50 p-2 rounded text-red-700">
                                <span>T·ªâ l·ªá</span>
                                <span class="font-bold">10% - 15%</span>
                            </div>
                            <div class="flex justify-between bg-red-50 p-2 rounded text-red-700">
                                <span>Cao ƒëi·ªÉm</span>
                                <span class="font-bold">10h - 13h</span>
                            </div>
                        </div>
                    </div>

                    <div class="p-4 md:p-5 border-l-4 border-l-blue-500 flex-1">
                        <div class="flex items-center mb-3">
                            <span class="text-xl mr-2">üîß</span>
                            <h3 class="font-bold text-gray-800 text-sm md:text-base">B·∫£o Tr√¨ & Tu·ªïi Th·ªç</h3>
                        </div>
                        <ul class="text-xs space-y-3 text-gray-600">
                            <li class="relative pl-3">
                                <span class="absolute left-0 top-1.5 w-1.5 h-1.5 bg-blue-500 rounded-full"></span>
                                <strong>Inverter:</strong> Thay linh ki·ªán m·ªói 5 nƒÉm.
                            </li>
                            <li class="relative pl-3">
                                <span class="absolute left-0 top-1.5 w-1.5 h-1.5 bg-blue-500 rounded-full"></span>
                                <strong>Pin:</strong> V·ªá sinh 2 l·∫ßn/th√°ng (M√πa kh√¥).
                            </li>
                        </ul>
                    </div>
                </div>
            </div>

            <!-- 5. SECTION: DELTA TABLE -->
             <div class="bg-white rounded-xl shadow-sm border border-gray-300 overflow-hidden mt-8">
                <div class="px-4 md:px-6 py-4 border-b flex flex-col md:flex-row justify-between items-start md:items-center bg-teal-700 gap-2">
                    <h2 class="text-base md:text-lg font-bold text-white flex items-center gap-2">
                        <i data-lucide="activity" class="w-5 h-5 shrink-0"></i> Ph√¢n t√≠ch Bi·∫øn ƒë·ªông
                    </h2>
                    <span class="text-[10px] md:text-xs bg-white/20 text-white px-2 py-1 rounded">Tr∆∞·ª£t ƒë·ªÉ xem chi ti·∫øt &rarr;</span>
                </div>
                <div class="overflow-x-auto w-full">
                    <table class="w-full text-sm text-left min-w-[600px]">
                        <thead class="text-xs uppercase bg-slate-100 text-gray-700 font-bold border-b-2 border-gray-200">
                            <tr>
                                <th class="px-4 md:px-6 py-3 border-r whitespace-nowrap sticky left-0 bg-slate-100 z-10 shadow-sm">NƒÉm</th>
                                <th class="px-4 md:px-6 py-3 text-right text-gray-600 border-r whitespace-nowrap">23 vs 22</th>
                                <th class="px-4 md:px-6 py-3 text-right text-gray-600 border-r whitespace-nowrap">24 vs 23</th>
                                <th class="px-4 md:px-6 py-3 text-right text-gray-600 border-r whitespace-nowrap">25 vs 24</th>
                                <th class="px-4 md:px-6 py-3 text-right text-gray-600 whitespace-nowrap">25 vs 22</th>
                            </tr>
                        </thead>
                        <tbody id="delta-table-body"></tbody>
                        <tfoot id="delta-table-footer" class="bg-gray-100 font-bold text-gray-800 border-t-2 border-gray-300"></tfoot>
                    </table>
                </div>
            </div>

            <!-- Main Data Table -->
            <div class="bg-white rounded-xl shadow-sm border border-gray-300 overflow-hidden mt-8">
                <div class="px-4 md:px-6 py-4 border-b flex flex-col md:flex-row justify-between items-start md:items-center bg-gray-800 gap-2">
                    <h2 class="text-base md:text-lg font-bold text-white flex items-center gap-2">
                        <i data-lucide="table" class="w-5 h-5 shrink-0"></i> D·ªØ li·ªáu Chi ti·∫øt
                    </h2>
                    <span class="text-[10px] md:text-xs bg-white/20 text-white px-2 py-1 rounded">Ch·∫°m v√†o nƒÉm ƒë·ªÉ m·ªü r·ªông</span>
                </div>
                <div class="overflow-x-auto max-h-[60vh] md:max-h-96 w-full">
                    <table class="w-full text-sm text-left min-w-[600px]" id="main-data-table">
                        <thead class="text-xs uppercase bg-gray-100 text-gray-700 sticky top-0 z-20 shadow-sm">
                            <tr>
                                <th class="px-4 md:px-6 py-3 sticky left-0 bg-gray-100 border-r z-30">Th·ªùi gian</th>
                                <th class="px-4 md:px-6 py-3 text-right whitespace-nowrap">√Ånh Quang</th>
                                <th class="px-4 md:px-6 py-3 text-right whitespace-nowrap">Duy Ti√™n</th>
                                <th class="px-4 md:px-6 py-3 text-right whitespace-nowrap">Khoa Vi·ªát</th>
                                <th class="px-4 md:px-6 py-3 text-right font-bold whitespace-nowrap">T·ªïng c·ªông</th>
                            </tr>
                        </thead>
                        <tbody id="main-table-body"></tbody>
                    </table>
                </div>
            </div>

        </div>

        <!-- ANALYSIS TAB (UPDATED WITH DEEP DIVE) -->
        <div id="tab-analysis" class="space-y-8 md:space-y-12 hidden-tab animate-fade-in pb-12">
            <div class="bg-blue-50 border border-blue-200 p-4 rounded-lg mb-4 md:mb-8">
                <h3 class="text-base md:text-lg font-bold text-blue-800 flex items-center gap-2"><i data-lucide="info" class="w-5 h-5"></i> Ph∆∞∆°ng ph√°p Ph√¢n t√≠ch</h3>
                <p class="text-sm text-blue-700 mt-1">H·ªá th·ªëng t·ª± ƒë·ªông ph√°t hi·ªán c√°c ƒëi·ªÉm "Delta √Çm" v√† "D·ªØ li·ªáu Ph·∫≥ng" ƒë·ªÉ c·∫£nh b√°o.</p>
            </div>

            <!-- Components generated by JS below will follow grid layout logic -->
            <div id="analysis-container"></div>
        </div>

        <!-- STRATEGY TAB (UPDATED WITH DOC CONTENT) -->
        <div id="tab-strategy" class="hidden-tab animate-fade-in">
            <div class="max-w-5xl mx-auto space-y-6 md:space-y-8">
                
                <!-- 1. Strategic Roadmap -->
                <div class="bg-white p-4 md:p-8 rounded-xl border border-gray-300 shadow-md">
                    <h2 class="text-xl md:text-2xl font-bold mb-6 text-gray-800 flex flex-col md:flex-row items-start md:items-center gap-3">
                        <span class="bg-primary text-white p-2 rounded-lg inline-flex"><i data-lucide="map"></i></span>
                        Chi·∫øn l∆∞·ª£c Qu·∫£n tr·ªã T√†i s·∫£n (25-30)
                    </h2>
                    
                    <div class="grid grid-cols-1 md:grid-cols-3 gap-4 md:gap-6 mb-8">
                        <div class="bg-blue-50 p-4 md:p-5 rounded-xl border border-blue-100">
                            <h3 class="font-bold text-blue-800 mb-2">1. Ki·ªÉm to√°n O&M</h3>
                            <p class="text-sm text-gray-600 mb-2">Th·ª±c hi·ªán ngay th√≠ nghi·ªám ƒë·ªãnh k·ª≥ 3 nƒÉm (C-Test) ƒë·ªÉ ƒë·∫£m b·∫£o tu√¢n th·ªß Hƒê.</p>
                            <div class="text-xs font-semibold text-blue-600 bg-white inline-block px-2 py-1 rounded">H·∫°n ch√≥t: Q1/2025</div>
                        </div>
                        <div class="bg-orange-50 p-4 md:p-5 rounded-xl border border-orange-100">
                            <h3 class="font-bold text-orange-800 mb-2">2. V·ªá sinh Chuy√™n s√¢u</h3>
                            <p class="text-sm text-gray-600 mb-2">Quy tr√¨nh v·ªá sinh ri√™ng cho <strong>b·ª•i ƒë·∫•t ƒë·ªè Bazan</strong>. Tuy·ªát ƒë·ªëi kh√¥ng qu√©t kh√¥.</p>
                            <div class="text-xs font-semibold text-orange-600 bg-white inline-block px-2 py-1 rounded">2 l·∫ßn/th√°ng (M√πa kh√¥)</div>
                        </div>
                        <div class="bg-green-50 p-4 md:p-5 rounded-xl border border-green-100">
                            <h3 class="font-bold text-green-800 mb-2">3. Qu·ªπ Thay Inverter</h3>
                            <p class="text-sm text-gray-600 mb-2">Tr√≠ch l·∫≠p d·ª± ph√≤ng 10-15% t·ªïng m·ª©c ƒë·∫ßu t∆∞ cho giai ƒëo·∫°n 2030-2032.</p>
                            <div class="text-xs font-semibold text-green-600 bg-white inline-block px-2 py-1 rounded">M·ª•c ti√™u: 5-7 T·ª∑</div>
                        </div>
                    </div>

                    <h3 class="font-bold text-lg text-gray-800 mb-4 border-l-4 border-primary pl-3">Ph√¢n t√≠ch R·ªßi ro & Khuy·∫øn ngh·ªã</h3>
                    <div class="space-y-4 text-gray-700 text-sm leading-relaxed">
                        <p><strong><i data-lucide="thermometer" class="inline w-4 h-4 text-red-500"></i> T√°c ƒë·ªông Nhi·ªát ƒë·ªô:</strong> Pleiku c√≥ bi√™n ƒë·ªô nhi·ªát l·ªõn g√¢y "s·ªëc nhi·ªát", l√†m m·ªèi m·ªëi h√†n. C·∫ßn d√πng Flycam nhi·ªát h√†ng nƒÉm.</p>
                        
                        <p><strong><i data-lucide="zap-off" class="inline w-4 h-4 text-yellow-600"></i> R·ªßi ro C·∫Øt gi·∫£m:</strong> Bi·ªÉu ƒë·ªì 2022 "ph·∫≥ng" ·ªü m√πa m∆∞a c·∫£nh b√°o qu√° t·∫£i l∆∞·ªõi. C·∫ßn duy tr√¨ li√™n l·∫°c 24/7 v·ªõi A3/A0.</p>
                        
                        <p><strong><i data-lucide="trending-up" class="inline w-4 h-4 text-green-600"></i> T·ªëi ∆∞u T√†i ch√≠nh:</strong> D√≤ng ti·ªÅn d∆∞∆°ng m·∫°nh (~800tr/nƒÉm/cty), n√™n ∆∞u ti√™n t·∫•t to√°n kho·∫£n vay l√£i cao.</p>
                    </div>
                </div>

            </div>
        </div>

    </main>

    <!-- LOGIC SCRIPT -->
    <script>
        // --- 1. CONFIG & REAL DATA FROM EXCEL ---
        const companies = ['√Ånh Quang', 'Duy Ti√™n', 'Khoa Vi·ªát'];
        const COLORS = {
            primary: '#009BB3', secondary: '#CBDAA4', accent1: '#DFE583', accent2: '#F36859', neutral: '#CCCCCC'
        };

        // NEW: EXACT DATA FROM USER IMAGE
        const REAL_DATA = {
            '√Ånh Quang': {
                2022: [262952444, 252743531, 308893847, 288858725, 235423065, 265708228, 265708228, 217432480, 201584179, 208787952, 216293278, 227515667],
                2023: [236882007, 228663525, 326024048, 280005878, 269179097, 218184872, 208954179, 187901534, 203487541, 198087126, 226588841, 249487197],
                2024: [278904398, 249754660, 313341331, 320489515, 275691925, 241153523, 167894891, 244884137, 190760012, 204162588, 223640364, 222880424],
                2025: [265496396, 241786170, 302346672, 318589509, 285753698, 196973028, 158748629, 218569218, 174460755, 211700806, 206310016, 0]
            },
            'Duy Ti√™n': {
                2022: [260750559, 252039907, 313547540, 293717083, 238304574, 269125832, 269125832, 219442835, 204733736, 213646311, 219978930, 232374026],
                2023: [236506617, 232527746, 335005750, 286724748, 276246095, 224277112, 215414169, 194908401, 209398517, 201983628, 229767566, 253691317],
                2024: [282565926, 253241316, 318762379, 327605315, 282047786, 247647554, 172281816, 250894570, 194248827, 207234731, 226783751, 225367500],
                2025: [266236308, 244252544, 306469040, 326129568, 288572411, 202716157, 163117635, 224735154, 179499205, 216034578, 211559871, 0]
            },
            'Khoa Vi·ªát': {
                2022: [260836607, 255088945, 312509200, 293267869, 237936009, 269159338, 269159338, 218471163, 204365171, 212105038, 219208293, 231469366],
                2023: [238895465, 231657426, 332742918, 284914483, 273008505, 221387650, 212577242, 192276554, 207074288, 200958233, 230177724, 252836821],
                2024: [281978700, 251928693, 316933774, 325187325, 280009765, 245264107, 170934650, 249098349, 193350716, 207787414, 226541952, 225712927],
                2025: [266342010, 244182076, 305059684, 323028983, 288678113, 200778291, 161990149, 223114394, 178019381, 215787941, 210432385, 0]
            }
        };

        const totalRevenue = Object.values(REAL_DATA).reduce((acc, company) => {
            return acc + Object.values(company).reduce((sum, yearArr) => sum + yearArr.reduce((a,b)=>a+b, 0), 0);
        }, 0);

        const formatMoney = (val) => new Intl.NumberFormat('vi-VN').format((val/1000000).toFixed(0)) + ' tr';
        const formatCurrencyFull = (val) => new Intl.NumberFormat('vi-VN', { style: 'currency', currency: 'VND' }).format(val);
        const formatNumber = (val) => new Intl.NumberFormat('vi-VN').format(val);

        // --- 2. DATA PROCESSING ---
        const getMonthlyTotal = () => {
             return Array.from({length: 12}, (_, i) => {
                let y22=0, y23=0, y24=0, y25=0;
                companies.forEach(c => {
                    y22 += REAL_DATA[c][2022][i] || 0;
                    y23 += REAL_DATA[c][2023][i] || 0;
                    y24 += REAL_DATA[c][2024][i] || 0;
                    y25 += REAL_DATA[c][2025][i] || 0;
                });
                return { label: `T${i+1}`, 2022: y22, 2023: y23, 2024: y24, 2025: y25 };
            });
        };

        const getCompanyTotal = () => {
            const result = {};
            companies.forEach(c => {
                result[c] = Object.values(REAL_DATA[c]).reduce((sum, arr) => sum + arr.reduce((a,b)=>a+b, 0), 0);
            });
            return result;
        };

        // --- 3. CHART RENDERING ---
        const renderTotalRevenueChart = () => {
            const ctx = document.getElementById('chart-total-revenue-line').getContext('2d');
            const data = getMonthlyTotal();
            const labels = data.map(d => d.label);
            
            new Chart(ctx, {
                type: 'line',
                data: {
                    labels: labels,
                    datasets: [
                        { label: '2025', data: data.map(d => d[2025]), borderColor: COLORS.accent2, borderWidth: 3, tension: 0.4, pointRadius: 3, pointHoverRadius: 6, backgroundColor: COLORS.accent2 },
                        { label: '2024', data: data.map(d => d[2024]), borderColor: COLORS.primary, borderWidth: 2, tension: 0.4, pointRadius: 2, pointHoverRadius: 5, backgroundColor: COLORS.primary },
                        { label: '2023', data: data.map(d => d[2023]), borderColor: COLORS.secondary, borderWidth: 2, tension: 0.4, pointRadius: 2, pointHoverRadius: 5, backgroundColor: COLORS.secondary },
                        { label: '2022', data: data.map(d => d[2022]), borderColor: COLORS.neutral, borderWidth: 2, borderDash: [5,5], tension: 0.4, pointRadius: 1 }
                    ]
                },
                options: {
                    responsive: true, maintainAspectRatio: false,
                    interaction: { mode: 'index', intersect: false },
                    plugins: { legend: { position: 'top', labels: { boxWidth: 10, font: { size: 10 } } }, datalabels: { display: false } },
                    scales: { 
                        y: { 
                            beginAtZero: false, 
                            ticks: { font: { size: 10 } },
                            grid: { borderDash: [2, 2] } 
                        },
                        x: { ticks: { font: { size: 10 } } }
                    }
                }
            });
        };

        const renderTotalDeltaChart = () => {
            const ctx = document.getElementById('chart-total-delta-line').getContext('2d');
            const monthlyTotal = getMonthlyTotal();
            const labels = monthlyTotal.map(m => m.label);
            
            const d23_22 = monthlyTotal.map(m => m[2023] - m[2022]);
            const d24_23 = monthlyTotal.map(m => m[2024] - m[2023]);
            const d25_24 = monthlyTotal.map(m => m[2025] - m[2024]);
            const d25_22 = monthlyTotal.map(m => m[2025] - m[2022]);

            new Chart(ctx, {
                type: 'line',
                data: {
                    labels: labels,
                    datasets: [
                        { label: '23 vs 22', data: d23_22, borderColor: COLORS.neutral, borderWidth: 1, tension: 0.4, pointRadius: 1 },
                        { label: '24 vs 23', data: d24_23, borderColor: COLORS.secondary, borderWidth: 2, tension: 0.4, pointRadius: 2 },
                        { label: '25 vs 24', data: d25_24, borderColor: COLORS.primary, borderWidth: 2, tension: 0.4, pointRadius: 2 },
                        { label: '25 vs 22', data: d25_22, borderColor: COLORS.accent2, borderWidth: 3, tension: 0.4, pointRadius: 3 }
                    ]
                },
                options: {
                    responsive: true, maintainAspectRatio: false,
                    interaction: { mode: 'index', intersect: false },
                    plugins: { legend: { position: 'top', labels: { boxWidth: 10, font: { size: 10 } } }, datalabels: { display: false } },
                    scales: { 
                        y: { ticks: { callback: (val) => (val/1000000).toFixed(0), font: { size: 10 } } },
                        x: { ticks: { font: { size: 10 } } }
                    }
                }
            });
        };

        const renderComparisonChart = () => {
            const ctx = document.getElementById('chart-comparison').getContext('2d');
            const totals = getCompanyTotal();
            const grandTotal = Object.values(totals).reduce((a,b) => a+b, 0);

            // Populate Table
            const tbody = document.getElementById('comparison-table-body');
            const sortedKeys = Object.keys(totals).sort((a,b) => totals[b] - totals[a]);
            
            tbody.innerHTML = ''; 
            sortedKeys.forEach(company => {
                const val = totals[company];
                const percentage = ((val/grandTotal)*100).toFixed(1);
                const row = document.createElement('tr');
                row.className = "border-b border-gray-50 hover:bg-gray-50 transition-colors";
                row.innerHTML = `
                    <td class="px-3 py-3 font-medium text-gray-800 whitespace-nowrap">${company}</td>
                    <td class="px-3 py-3 text-right font-mono text-primary whitespace-nowrap">${formatMoney(val)}</td>
                    <td class="px-3 py-3 text-right text-xs text-gray-500">${percentage}%</td>
                `;
                tbody.appendChild(row);
            });
            
            new Chart(ctx, {
                type: 'bar',
                data: {
                    labels: Object.keys(totals),
                    datasets: [{
                        label: 'T·ªïng Doanh Thu (VNƒê)',
                        data: Object.values(totals),
                        backgroundColor: [COLORS.primary, COLORS.secondary, COLORS.accent2],
                        borderRadius: 8,
                        barThickness: 'flex',
                        maxBarThickness: 40
                    }]
                },
                options: {
                    responsive: true, maintainAspectRatio: false,
                    indexAxis: 'y',
                    plugins: { 
                        legend: { display: false },
                        datalabels: {
                            color: '#fff', anchor: 'end', align: 'start', offset: -50,
                            formatter: (value) => (value/1000000000).toFixed(1) + 'T·ª∑', 
                            font: { weight: 'bold', size: 11 }
                        }
                    },
                    scales: { 
                        x: { display: false, max: Math.max(...Object.values(totals)) * 1.2 }, 
                        y: { grid: { display: false }, ticks: { font: { size: 11 } } } 
                    },
                }
            });
        };

        const renderFinancialChart = () => {
            const ctx = document.getElementById('chart-financial-roi').getContext('2d');
            const labels = ['20', '21', '22', '23', '24', '25'];
            
            const initialInv = -42000000000;
            const cf2021 = 10000000000 / 1.08;
            
            const getRev = (y) => {
               return Object.values(REAL_DATA).reduce((acc, c) => acc + c[y].reduce((a,b)=>a+b,0), 0); 
            };
            
            const cf22 = getRev(2022) / 1.08;
            const cf23 = getRev(2023) / 1.08;
            const cf24 = getRev(2024) / 1.08;
            const cf25 = getRev(2025) / 1.08;

            const cashflow = [
                initialInv,
                initialInv + cf2021,
                initialInv + cf2021 + cf22,
                initialInv + cf2021 + cf22 + cf23,
                initialInv + cf2021 + cf22 + cf23 + cf24,
                initialInv + cf2021 + cf22 + cf23 + cf24 + cf25
            ];

            const accRevenue = cf2021 + cf22 + cf23 + cf24 + cf25;
            document.getElementById('fin-acc-revenue').innerText = '~' + (accRevenue/1000000000).toFixed(1) + ' T·ª∑';

            new Chart(ctx, {
                type: 'line',
                data: {
                    labels: labels,
                    datasets: [{
                        label: 'D√≤ng ti·ªÅn',
                        data: cashflow,
                        borderColor: '#2dd4bf', 
                        backgroundColor: 'rgba(45, 212, 191, 0.1)',
                        borderWidth: 2,
                        pointRadius: 4,
                        fill: true,
                        tension: 0.4,
                    }]
                },
                options: {
                    responsive: true, maintainAspectRatio: false,
                    plugins: { legend: { display: false }, datalabels: { display: false } },
                    scales: { 
                        y: { 
                            ticks: { callback: (val) => (val/1000000000).toFixed(0) + 't·ª∑', color: '#94a3b8', font: { size: 10 } },
                            grid: { color: '#334155' }
                        },
                        x: { ticks: { color: '#94a3b8', font: { size: 10 } }, grid: { display: false } }
                    }
                }
            });
        };

        const renderStandardLineChart = (canvasId, company, type='revenue') => {
            const ctx = document.getElementById(canvasId).getContext('2d');
            const data = REAL_DATA[company];
            const labels = Array.from({length: 12}, (_, i) => `T${i+1}`);
            let datasets = [];
            
            if (type === 'revenue') {
                datasets = [
                    { label: '22', data: data[2022], borderColor: COLORS.neutral, borderDash: [5,5], pointRadius: 0, tension: 0.4 },
                    { label: '23', data: data[2023], borderColor: COLORS.secondary, pointRadius: 1, tension: 0.4 },
                    { label: '24', data: data[2024], borderColor: COLORS.primary, pointRadius: 1, tension: 0.4 },
                    { label: '25', data: data[2025], borderColor: COLORS.accent2, pointRadius: 2, tension: 0.4 }
                ];
            } else {
                const d23_22 = data[2023].map((v, i) => v - data[2022][i]);
                const d24_23 = data[2024].map((v, i) => v - data[2023][i]);
                const d25_24 = data[2025].map((v, i) => v - data[2024][i]);
                const d25_22 = data[2025].map((v, i) => v - data[2022][i]);

                datasets = [
                    { label: '23-22', data: d23_22, borderColor: COLORS.neutral, borderWidth: 1, tension: 0.4, pointRadius: 0 },
                    { label: '24-23', data: d24_23, borderColor: COLORS.secondary, borderWidth: 2, tension: 0.4, pointRadius: 1 },
                    { label: '25-24', data: d25_24, borderColor: COLORS.primary, borderWidth: 2, tension: 0.4, pointRadius: 1 },
                    { label: '25-22', data: d25_22, borderColor: COLORS.accent2, borderWidth: 2, tension: 0.4, pointRadius: 2 }
                ];
            }

            new Chart(ctx, {
                type: 'line',
                data: { labels, datasets },
                options: {
                    responsive: true, maintainAspectRatio: false,
                    plugins: { legend: { position: 'bottom', labels: { boxWidth: 8, font: { size: 10 } } }, datalabels: { display: false } },
                    scales: { 
                        y: { ticks: { callback: (val) => (val/1000000).toFixed(0), font: { size: 10 } } },
                        x: { ticks: { font: { size: 10 } } }
                    }
                }
            });
            
            if(type === 'revenue') {
                // Return analysis HTML string for this company
                return generateAnalysisBox(company);
            }
            return "";
        };

        const generateAnalysisBox = (company) => {
            const data = REAL_DATA[company];
            let anomalies = [];
            
            const t6_22 = data[2022][5];
            const t7_22 = data[2022][6];
            if (t6_22 === t7_22) {
                anomalies.push(`<span class="text-orange-600 font-bold"><i data-lucide="alert-triangle" class="w-3 h-3 inline"></i> T6-T7/22 Ph·∫≥ng:</span> Doanh thu gi·ªØ nguy√™n m·ª©c ${formatMoney(t6_22)}. D·∫•u hi·ªáu Curtailment.`);
            }
            
            const delta24_22_t7 = data[2024][6] - data[2022][6];
            if (delta24_22_t7 < -50000000) {
                 anomalies.push(`<span class="text-blue-600 font-bold"><i data-lucide="cloud-rain" class="w-3 h-3 inline"></i> T7/24 Gi·∫£m s√¢u:</span> Th·∫•p h∆°n T7/22 ${formatMoney(Math.abs(delta24_22_t7))}. C·∫ßn ki·ªÉm tra ti·∫øt gi·∫£m/th·ªùi ti·∫øt.`);
            }

            const sum24 = data[2024].reduce((a,b)=>a+b,0);
            const sum23 = data[2023].reduce((a,b)=>a+b,0);
            if(sum24 > sum23) {
                 anomalies.push(`<span class="text-green-600 font-bold"><i data-lucide="trending-up" class="w-3 h-3 inline"></i> Ph·ª•c h·ªìi 24:</span> T·ªïng tƒÉng (+${formatMoney(sum24-sum23)}).`);
            }

            return `
                <div class="p-3 md:p-4 rounded-lg border-l-4 text-sm shadow-sm bg-gray-50 border-gray-300 space-y-2">
                    <h5 class="font-bold text-gray-800 border-b border-gray-200 pb-2 mb-2">Nh·∫≠n ƒë·ªãnh Chuy√™n gia:</h5>
                    <ul class="list-disc pl-4 space-y-1 text-gray-600 text-xs md:text-sm">
                        ${anomalies.map(a => `<li>${a}</li>`).join('')}
                        <li><strong>Khuy·∫øn ngh·ªã:</strong> R√† so√°t bi√™n b·∫£n O&M th√°ng 7.</li>
                    </ul>
                </div>
            `;
        };

        const renderAnalysisTab = () => {
             const container = document.getElementById('analysis-container');
             companies.forEach((company, index) => {
                 let code = company === '√Ånh Quang' ? 'aq' : (company === 'Duy Ti√™n' ? 'dt' : 'kv');
                 
                 // Create Analysis Structure using string template
                 const html = `
                    <div class="border-t border-gray-300 pt-6">
                        <h3 class="text-base md:text-lg font-bold mb-4 px-3 py-1 rounded w-fit text-white bg-primary">${index+1}. C√¥ng ty ${company}</h3>
                        <div class="grid grid-cols-1 lg:grid-cols-2 gap-4 md:gap-8">
                            <div class="bg-white p-3 md:p-5 rounded-xl border border-gray-300 shadow-sm">
                                <h4 class="font-bold mb-2 md:mb-4 text-gray-700 text-sm md:text-base">Bi·ªÉu ƒë·ªì Doanh thu</h4>
                                <div class="h-64 md:h-72"><canvas id="chart-${code}-revenue"></canvas></div>
                            </div>
                            <div>
                                <div class="bg-white p-3 md:p-5 rounded-xl border border-gray-300 shadow-sm mb-4 md:mb-6">
                                    <h4 class="font-bold mb-2 md:mb-4 text-gray-700 text-sm md:text-base">Bi·ªÉu ƒë·ªì Delta</h4>
                                    <div class="h-56 md:h-64"><canvas id="chart-${code}-delta"></canvas></div>
                                </div>
                                <div id="analysis-box-${code}"></div>
                            </div>
                        </div>
                    </div>
                 `;
                 container.innerHTML += html;
             });

             // Render Charts after DOM injection
             setTimeout(() => {
                 companies.forEach(company => {
                    let code = company === '√Ånh Quang' ? 'aq' : (company === 'Duy Ti√™n' ? 'dt' : 'kv');
                    const analysisHtml = renderStandardLineChart(`chart-${code}-revenue`, company, 'revenue');
                    renderStandardLineChart(`chart-${code}-delta`, company, 'delta');
                    document.getElementById(`analysis-box-${code}`).innerHTML = analysisHtml;
                 });
                 lucide.createIcons();
             }, 100);
        };

        const renderDeltaTable = () => {
            const tbody = document.getElementById('delta-table-body');
            const tfoot = document.getElementById('delta-table-footer');
            tbody.innerHTML = "";
            tfoot.innerHTML = "";

            let total23_22 = 0;
            let total24_23 = 0;
            let total25_24 = 0;
            let total25_22 = 0;

            companies.forEach(company => {
                const data = REAL_DATA[company];
                const d23_22 = data[2023].map((v, i) => v - data[2022][i]);
                const d24_23 = data[2024].map((v, i) => v - data[2023][i]);
                const d25_24 = data[2025].map((v, i) => v - data[2024][i]);
                const d25_22 = data[2025].map((v, i) => v - data[2022][i]);

                const sum = (arr) => arr.reduce((a,b)=>a+b,0);
                const sumYTD = (arr) => arr.slice(0, 11).reduce((a,b)=>a+b,0);

                const deltaYear23_22 = sum(data[2023]) - sum(data[2022]);
                const deltaYear24_23 = sum(data[2024]) - sum(data[2023]);
                const deltaYear25_24 = sumYTD(data[2025]) - sumYTD(data[2024]);
                const deltaYear25_22 = sumYTD(data[2025]) - sumYTD(data[2022]);

                total23_22 += deltaYear23_22;
                total24_23 += deltaYear24_23;
                total25_24 += deltaYear25_24;
                total25_22 += deltaYear25_22;

                const header = document.createElement('tr');
                header.className = "bg-gray-50 border-b border-gray-200 cursor-pointer font-bold hover:bg-blue-50";
                header.innerHTML = `
                    <td class="px-4 md:px-6 py-3 text-primary flex items-center gap-2 border-r whitespace-nowrap sticky left-0 bg-gray-50 z-10"><i data-lucide="chevron-down" class="w-4 h-4"></i> ${company}</td>
                    <td class="text-right px-4 md:px-6 text-gray-700 border-r whitespace-nowrap">${formatNumber(deltaYear23_22)}</td>
                    <td class="text-right px-4 md:px-6 text-gray-700 border-r whitespace-nowrap">${formatNumber(deltaYear24_23)}</td>
                    <td class="text-right px-4 md:px-6 text-gray-700 border-r whitespace-nowrap">${formatNumber(deltaYear25_24)}</td>
                    <td class="text-right px-4 md:px-6 text-gray-700 whitespace-nowrap">${formatNumber(deltaYear25_22)}</td>
                `;
                
                const detailsFrag = document.createDocumentFragment();
                for(let i=0; i<12; i++) {
                    const row = document.createElement('tr');
                    row.className = `border-b border-gray-100 bg-white group-delta-${company.replace(/\s/g,'')}`;
                    const fmt = (val) => `<span class="${val>0?'text-black':(val<0?'text-black':'text-gray-400')}">${formatNumber(val)}</span>`;
                    let val25_24 = fmt(d25_24[i]);
                    let val25_22 = fmt(d25_22[i]);
                    if (i === 11) { val25_24 = '<span class="text-gray-300">-</span>'; val25_22 = '<span class="text-gray-300">-</span>'; }

                    row.innerHTML = `
                        <td class="px-4 md:px-6 py-2 pl-12 text-gray-500 text-xs border-r sticky left-0 bg-white z-10">T${i+1}</td>
                        <td class="text-right px-4 md:px-6 font-mono text-xs border-r text-gray-600 whitespace-nowrap">${fmt(d23_22[i])}</td>
                        <td class="text-right px-4 md:px-6 font-mono text-xs border-r text-gray-600 whitespace-nowrap">${fmt(d24_23[i])}</td>
                        <td class="text-right px-4 md:px-6 font-mono text-xs border-r text-gray-600 whitespace-nowrap">${val25_24}</td>
                        <td class="text-right px-4 md:px-6 font-mono text-xs text-gray-600 whitespace-nowrap">${val25_22}</td>
                    `;
                    detailsFrag.appendChild(row);
                }
                header.onclick = () => { document.querySelectorAll(`.group-delta-${company.replace(/\s/g,'')}`).forEach(r => r.style.display = r.style.display === 'none' ? 'table-row' : 'none'); };
                tbody.appendChild(header);
                tbody.appendChild(detailsFrag);
            });

            const footerRow = document.createElement('tr');
            footerRow.innerHTML = `
                <td class="px-4 md:px-6 py-4 uppercase border-r sticky left-0 bg-gray-100 z-10">T·ªïng s·ªë</td>
                <td class="text-right px-4 md:px-6 border-r whitespace-nowrap">${formatNumber(total23_22)}</td>
                <td class="text-right px-4 md:px-6 border-r whitespace-nowrap">${formatNumber(total24_23)}</td>
                <td class="text-right px-4 md:px-6 border-r whitespace-nowrap">${formatNumber(total25_24)}</td>
                <td class="text-right px-4 md:px-6 whitespace-nowrap">${formatNumber(total25_22)}</td>
            `;
            tfoot.appendChild(footerRow);
        };

        const renderMainTable = () => {
            const tbody = document.getElementById('main-table-body');
            const years = [2025, 2024, 2023, 2022];
            years.forEach(year => {
                const aqTotal = REAL_DATA['√Ånh Quang'][year].reduce((a,b)=>a+b,0);
                const dtTotal = REAL_DATA['Duy Ti√™n'][year].reduce((a,b)=>a+b,0);
                const kvTotal = REAL_DATA['Khoa Vi·ªát'][year].reduce((a,b)=>a+b,0);
                const yearTotal = aqTotal + dtTotal + kvTotal;

                const header = document.createElement('tr');
                header.className = "bg-secondary/30 cursor-pointer hover:bg-secondary/50 font-bold border-b border-gray-200";
                header.innerHTML = `<td class="px-4 md:px-6 py-3 flex gap-2 sticky left-0 bg-secondary/30 z-10 items-center"><i data-lucide="chevron-down" class="w-4 h-4"></i> NƒÉm ${year}</td><td class="text-right px-4 md:px-6 whitespace-nowrap">${formatMoney(aqTotal)}</td><td class="text-right px-4 md:px-6 whitespace-nowrap">${formatMoney(dtTotal)}</td><td class="text-right px-4 md:px-6 whitespace-nowrap">${formatMoney(kvTotal)}</td><td class="text-right px-4 md:px-6 text-primary whitespace-nowrap">${formatMoney(yearTotal)}</td>`;
                
                const detailsFrag = document.createDocumentFragment();
                for(let m=0; m<12; m++) {
                    const aq = REAL_DATA['√Ånh Quang'][year][m];
                    const dt = REAL_DATA['Duy Ti√™n'][year][m];
                    const kv = REAL_DATA['Khoa Vi·ªát'][year][m];
                    const row = document.createElement('tr');
                    row.className = `border-b border-gray-100 bg-white group-year-${year}`;
                    row.innerHTML = `<td class="px-4 md:px-6 py-2 pl-12 text-gray-500 text-xs sticky left-0 bg-white z-10 shadow-sm border-r">T${m+1}</td><td class="text-right px-4 md:px-6 font-mono text-xs text-gray-600 whitespace-nowrap">${formatCurrencyFull(aq)}</td><td class="text-right px-4 md:px-6 font-mono text-xs text-gray-600 whitespace-nowrap">${formatCurrencyFull(dt)}</td><td class="text-right px-4 md:px-6 font-mono text-xs text-gray-600 whitespace-nowrap">${formatCurrencyFull(kv)}</td><td class="text-right px-4 md:px-6 font-mono text-xs font-medium whitespace-nowrap">${formatCurrencyFull(aq+dt+kv)}</td>`;
                    detailsFrag.appendChild(row);
                }
                header.onclick = () => { document.querySelectorAll(`.group-year-${year}`).forEach(r => r.style.display = r.style.display === 'none' ? 'table-row' : 'none'); };
                tbody.appendChild(header);
                tbody.appendChild(detailsFrag);
            });
            [2024, 2023, 2022].forEach(y => document.querySelectorAll(`.group-year-${y}`).forEach(r => r.style.display = 'none'));
        };

        // --- 5. INITIALIZATION ---
        function switchTab(tabId) {
            ['dashboard', 'analysis', 'strategy'].forEach(id => {
                document.getElementById(`tab-${id}`).classList.add('hidden-tab');
                document.getElementById(`btn-${id}`).classList.replace('active-tab-btn', 'inactive-tab-btn');
            });
            document.getElementById(`tab-${tabId}`).classList.remove('hidden-tab');
            document.getElementById(`btn-${tabId}`).classList.replace('inactive-tab-btn', 'active-tab-btn');
        }

        document.addEventListener('DOMContentLoaded', () => {
            lucide.createIcons();
            document.getElementById('kpi-total-revenue').innerText = formatMoney(totalRevenue);

            Chart.defaults.font.family = 'sans-serif';
            Chart.defaults.color = '#64748b';

            renderTotalRevenueChart();
            renderTotalDeltaChart(); 
            renderComparisonChart();
            renderFinancialChart();
            
            // Build Analysis Tab
            renderAnalysisTab();

            renderMainTable();
            renderDeltaTable();
        });
    </script>
</body>
</html>
